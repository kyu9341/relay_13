<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./relay13.css">
    <title>만리안</title>
</head>
<body>
<div class="wrapper">
    <header class="web-header">
        <h1 class="web-logo">
            <a href="#" class="web-logo-link"></a>
        </h1>
    </header>

    <main class="web-main">
        <div class="form-area">
            <h2 class="form-title">글작성</h2>
            <form action="/posts" method="post" id="formTag">

                <div class="form-group">
                    <label for="content-title" class="form-item-title">제목</label>
                    <input type="text" name="title" id="content-title" class="form-content-input">
                </div>

                <div class="form-group">
                    <label for="content-body" class="form-item-title">내용</label>
                    <textarea name="contents" id="content-body" class="form-content-body"></textarea>
                </div>
            </form>
            <div id = 'insertedImage'></div>
            <div id = 'insertedButton'></div>
            
            <div class="form-group button-group">
                <button type="reset" form="formTag" class="form-button-reset">리셋</button>
                <button type="submit" form="formTag" class="form-button-submit">전송</button>
            </div>
            <input type = 'file' onChange = 'handleFile(event)'></input>
        </div>
        

        <div class="posts-wrap">
            <h2 class="posts-title">글목록</h2>
            <ul id="posts" class="posts">
                <li class="post">
                    <div class="post-head">등록된 글이 없습니다.</div>
                </li>
                <!--<li class="post">
                    <div class="post-head">
                        제목:
                        <strong class="title">
                            What is Lorem Ipsum?
                        </strong>
                    </div>
                    <div class="post-body">
                        <div class="post-body-title">내용:</div>
                        <span class="positive">Lorem Ipsum is simply dummy text of the printing and typesetting industry.</span>
                        <span class="neutral">Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,</span>
                        <span class="negative">when an unknown printer took a galley of type and scrambled it to make a type specimen book.</span>
                        <span class="positive">It has survived not only five centuries, but also the leap into electronic typesetting,remaining essentially unchanged.</span>
                        <span class="negative">It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</span>
                    </div>
                </li>-->
            </ul>
        </div>
    </main>
    <footer class="web-footer">
        <p>&copy; 2020 부스트캠프 챌린지 릴레이 프로젝트</p>
    </footer>
</div>
<script src="index.js"></script>
<script src="objectDetection.js"></script>

<script>
    const imageResizing = (event) => {   
        const form = document.getElementById('formTag');
        const hiddenTag = document.getElementById('objectDetection');
        const insertHtml=`
         <input type="hidden" 
                id='objectDetection' 
                name=objectDetection 
                value = '${event.target.dataset.detection_boxes}'>
         </input>
         <input type="hidden" 
                id='file_path' 
                name=objectDetection 
                value = '${event.target.dataset.file_path}'>
         </input>
        `

        console.log(event.target.dataset.file_path)
        if(hiddenTag){
            hiddenTag.value = event.target.dataset.detection_boxes;
            document.getElementById('file_path').value = event.target.dataset.file_path
        }
        else
            form.insertAdjacentHTML('beforeend', insertHtml);
        
        // console.log(object)
    }
    const handleFile = (event) => {
        const files = new FormData();
        for(const file of Object.values(event.target.files))
            files.append('files', file)
        
        fetch('/saveImage',{
            method:'POST',
            body: files
        })
        .then(res => res.json())
        .then(res => {
            objectDetection(res)
        })
    }
</script>
</body>
</html>
